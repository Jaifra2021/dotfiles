#!/usr/bin/env bash

env_name=$1
[[ -z "$env_name" ]] && env_name="venv"
pip_args=(--no-warn-script-location --upgrade --upgrade-strategy eager)
PYTHON="python3"
PIP="$env_name/bin/pip3"
if [[ $(uname) =~ "MINGW" ]]; then
    PYTHON="python"
    PIP="$env_name/Scripts/pip"
fi
[[ ! -d $env_name ]] && $PYTHON -m venv $env_name
PYTHON=$(dirname $PIP)/python
$PYTHON -m pip install --upgrade pip wheel
[[ -f requirements.txt ]] && $PIP install -r requirements.txt ${pip_args[@]}
if [[ ! $(uname) =~ "MINGW" ]]; then
    $PIP install ipython pdbpp ${pip_args[@]}
else
    $PIP install ipython ${pip_args[@]}
fi
[[ -f setup.py ]] && $PYTHON setup.py develop

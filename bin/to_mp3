#!/usr/bin/env bash

# http://stackoverflow.com/a/2664746
# http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion
# http://www.tldp.org/LDP/LG/issue18/bash.html
# https://ubuntuforums.org/showthread.php?t=2293328&s=431c328035fd27e44bbb1607e27afe0b
#
# https://stackoverflow.com/questions/9913032/how-can-i-extract-audio-from-video-with-ffmpeg
# https://trac.ffmpeg.org/wiki/Encode/MP3

fname="$1"
[[ -z "$fname" ]] && echo "No filename specified" && exit 1
which avconf &>/dev/null
if [[ $? -eq 0 ]]; then
    time avconv -i "$fname" -acodec libmp3lame -ab 320k "${fname%.*}.mp3"
else
    time ffmpeg -i "$fname" -b:a 320k -map a "${fname%.*}.mp3"
fi
